window.wp=window.wp||{};window.bp=window.bp||{};function copyLink(link){var copyText=document.getElementById(link);copyText.select();document.execCommand("copy")}(function(exports,$){if(typeof SZ_Nouveau==="undefined"){return}var hash=window.location.hash;hash&&$('.sz-tabs ul.nav a[href="'+hash+'"]').tab("show");$(".nav-tabs a").click(function(e){$(this).tab("show");var scrollmem=$("body").scrollTop();window.location.hash=this.hash;$("html,body").scrollTop(scrollmem)});bp.Nouveau={start:function(){this.setupGlobals();this.prepareDocument();this.initObjects();this.setHeartBeat();this.addListeners()},setupGlobals:function(){this.ajax_request=null;this.objects=$.map(SZ_Nouveau.objects,function(value){return value});this.objectNavParent=SZ_Nouveau.object_nav_parent;this.heartbeat=wp.heartbeat||{};this.querystring=this.getLinkParams()},prepareDocument:function(){if($("body").hasClass("no-js")){$("body").removeClass("no-js").addClass("js")}if(SZ_Nouveau.warnings&&"undefined"!==typeof console&&console.warn){$.each(SZ_Nouveau.warnings,function(w,warning){console.warn(warning)})}if($(".sportszone_object_nav .widget-title").length){var text=$(".sportszone_object_nav .widget-title").html();$("body").find('*:contains("'+text+'")').each(function(e,element){if(!$(element).hasClass("widget-title")&&text===$(element).html()&&!$(element).is("a")){$(element).remove()}})}},getStorage:function(type,property){var store=sessionStorage.getItem(type);if(store){store=JSON.parse(store)}else{store={}}if(undefined!==property){return store[property]||false}return store},setStorage:function(type,property,value){var store=this.getStorage(type);if(undefined===value&&undefined!==store[property]){delete store[property]}else{store[property]=value}sessionStorage.setItem(type,JSON.stringify(store));return sessionStorage.getItem(type)!==null},getLinkParams:function(url,param){var qs;if(url){qs=-1!==url.indexOf("?")?"?"+url.split("?")[1]:""}else{qs=document.location.search}if(!qs){return null}var params=qs.replace(/(^\?)/,"").split("&").map(function(n){return n=n.split("="),this[n[0]]=n[1],this}.bind({}))[0];if(param){return params[param]}return params},ajax:function(post_data,object){if(this.ajax_request){this.ajax_request.abort()}var postData=$.extend({},bp.Nouveau.getStorage("sz-"+object),{nonce:SZ_Nouveau.nonces[object]},post_data);if(undefined!==SZ_Nouveau.customizer_settings){postData.customized=SZ_Nouveau.customizer_settings}this.ajax_request=$.post(SZ_Nouveau.ajaxurl,postData,"json");return this.ajax_request},inject:function(selector,content,method){if(!$(selector).length||!content){return}method=method||"reset";if("append"===method){$(selector).append(content)}else if("prepend"===method){$(selector).prepend(content)}else{$(selector).html(content)}if("undefined"!==typeof sz_mentions||"undefined"!==typeof bp.mentions){$(".sz-suggestions").sz_mentions(bp.mentions.users)}},objectRequest:function(data){var postdata={},self=this;data=$.extend({object:"",scope:null,filter:null,target:"#sportszone [data-sz-list]",search_terms:"",page:1,extras:null,caller:null,template:null,method:"reset"},data);if(!data.object||!data.target){return}if(null!==data.scope){this.setStorage("sz-"+data.object,"scope",data.scope)}if(null!==data.filter){this.setStorage("sz-"+data.object,"filter",data.filter)}if(null!==data.extras){this.setStorage("sz-"+data.object,"extras",data.extras)}$(this.objectNavParent+" [data-sz-object]").each(function(){$(this).removeClass("selected loading")});$(this.objectNavParent+' [data-sz-scope="'+data.scope+'"], #object-nav li.current').addClass("selected loading");$('#sportszone [data-sz-filter="'+data.object+'"] option[value="'+data.filter+'"]').prop("selected",true);if("friends"===data.object||"group_members"===data.object){data.template=data.object;data.object="members"}else if("group_requests"===data.object){data.object="groups";data.template="group_requests"}else if("friends"===data.object||"event_members"===data.object){data.template=data.object;data.object="members"}else if("event_requests"===data.object){data.object="events";data.template="event_requests"}else if("notifications"===data.object){data.object="members";data.template="member_notifications"}postdata=$.extend({action:data.object+"_filter"},data);return this.ajax(postdata,data.object).done(function(response){if(false===response.success){return}$(self.objectNavParent+' [data-sz-scope="'+data.scope+'"]').removeClass("loading");if("reset"!==data.method){self.inject(data.target,response.data.contents,data.method);$(data.target).trigger("sz_ajax_"+data.method,$.extend(data,{response:response.data}))}else{if(data.caller==="pag-bottom"&&$("#subnav").length){var top=$("#subnav").parent();$("html,body").animate({scrollTop:top.offset().top},"slow",function(){$(data.target).fadeOut(100,function(){self.inject(this,response.data.contents,data.method);$(this).fadeIn(100);$(data.target).trigger("sz_ajax_request",$.extend(data,{response:response.data}))})})}else{$(data.target).fadeOut(100,function(){self.inject(this,response.data.contents,data.method);$(this).fadeIn(100);$(data.target).trigger("sz_ajax_request",$.extend(data,{response:response.data}))})}}})},initObjects:function(){var self=this,objectData={},queryData={},scope="all",search_terms="",extras=null,filter=null;$.each(this.objects,function(o,object){objectData=self.getStorage("sz-"+object);if(undefined!==objectData.scope){scope=objectData.scope}if(undefined!==objectData.extras&&"notifications"!==object){extras=objectData.extras}if($('#sportszone [data-sz-filter="'+object+'"]').length){if("-1"!==$('#sportszone [data-sz-filter="'+object+'"]').val()&&"0"!==$('#sportszone [data-sz-filter="'+object+'"]').val()){filter=$('#sportszone [data-sz-filter="'+object+'"]').val()}else if(undefined!==objectData.filter){filter=objectData.filter,$('#sportszone [data-sz-filter="'+object+'"] option[value="'+filter+'"]').prop("selected",true)}}if($(this.objectNavParent+' [data-sz-object="'+object+'"]').length){$(this.objectNavParent+' [data-sz-object="'+object+'"]').each(function(){$(this).removeClass("selected")});$(this.objectNavParent+' [data-sz-scope="'+object+'"], #object-nav li.current').addClass("selected")}if(null!==self.querystring){if(undefined!==self.querystring[object+"_search"]){search_terms=self.querystring[object+"_search"]}else if(undefined!==self.querystring.s){search_terms=self.querystring.s}if(search_terms){$('#sportszone [data-sz-search="'+object+'"] input[type=search]').val(search_terms)}}if($('#sportszone [data-sz-list="'+object+'"]').length){queryData={object:object,scope:scope,filter:filter,search_terms:search_terms,extras:extras};self.objectRequest(queryData)}})},setHeartBeat:function(){if(typeof SZ_Nouveau.pulse==="undefined"||!this.heartbeat){return}this.heartbeat.interval(Number(SZ_Nouveau.pulse));$.fn.extend({"heartbeat-send":function(){return this.bind("heartbeat-send.sportszone")}});$.fn.extend({"heartbeat-tick":function(){return this.bind("heartbeat-tick.sportszone")}})},addListeners:function(){$("[data-sz-disable-input]").on("change",this.toggleDisabledInput);$(document).on("heartbeat-send.sportszone",this.heartbeatSend);$(document).on("heartbeat-tick.sportszone",this.heartbeatTick);$(this.objectNavParent+" .sz-navs").on("click","a",this,this.scopeQuery);$("#sportszone [data-sz-filter]").on("change",this,this.filterQuery);$("#sportszone [data-sz-search]").on("submit","form",this,this.searchQuery);$("#sportszone [data-sz-search] form").on("search","input[type=search]",this.resetSearch);$("#sportszone [data-sz-list], #sportszone #item-header").on("click","[data-sz-btn-action]",this,this.buttonAction);$("#sportszone [data-sz-close]").on("click",this,this.closeNotice);$("#sportszone [data-sz-list]").on("click","[data-sz-pagination] a",this,this.paginateAction)},toggleDisabledInput:function(){var disabledControl=$(this).attr("data-sz-disable-input");if($(disabledControl).prop("disabled",true)&&!$(this).hasClass("enabled")){$(this).addClass("enabled").removeClass("disabled");$(disabledControl).removeProp("disabled")}else if($(disabledControl).prop("disabled",false)&&$(this).hasClass("enabled")){$(this).removeClass("enabled").addClass("disabled");$(disabledControl).attr("disabled","disabled")}},heartbeatSend:function(event,data){$("#sportszone").trigger("sz_heartbeat_send",data)},heartbeatTick:function(event,data){$("#sportszone").trigger("sz_heartbeat_tick",data)},scopeQuery:function(event){var self=event.data,target=$(event.currentTarget).parent(),scope="all",object,filter=null,search_terms="";if(target.hasClass("no-ajax")||$(event.currentTarget).hasClass("no-ajax")||!target.attr("data-sz-scope")){return event}scope=target.data("sz-scope");object=target.data("sz-object");if(!scope||!object){return event}event.preventDefault();filter=$("#sportszone").find('[data-sz-filter="'+object+'"]').first().val();if($('#sportszone [data-sz-search="'+object+'"] input[type=search]').length){search_terms=$('#sportszone [data-sz-search="'+object+'"] input[type=search]').val()}if(target.hasClass("dynamic")){target.find("a span").html("")}self.objectRequest({object:object,scope:scope,filter:filter,search_terms:search_terms,page:1})},filterQuery:function(event){var self=event.data,object=$(event.target).data("sz-filter"),scope="all",filter=$(event.target).val(),search_terms="",template=null;if(!object){return event}if($(self.objectNavParent+" [data-sz-object].selected").length){scope=$(self.objectNavParent+" [data-sz-object].selected").data("sz-scope")}if($('#sportszone [data-sz-search="'+object+'"] input[type=search]').length){search_terms=$('#sportszone [data-sz-search="'+object+'"] input[type=search]').val()}if("friends"===object){object="members"}self.objectRequest({object:object,scope:scope,filter:filter,search_terms:search_terms,page:1,template:template})},searchQuery:function(event){var self=event.data,object,scope="all",filter=null,template=null,search_terms="";if($(event.delegateTarget).hasClass("no-ajax")||undefined===$(event.delegateTarget).data("sz-search")){return event}event.preventDefault();object=$(event.delegateTarget).data("sz-search");filter=$("#sportszone").find('[data-sz-filter="'+object+'"]').first().val();search_terms=$(event.delegateTarget).find("input[type=search]").first().val();if($(self.objectNavParent+" [data-sz-object]").length){scope=$(self.objectNavParent+' [data-sz-object="'+object+'"].selected').data("sz-scope")}self.objectRequest({object:object,scope:scope,filter:filter,search_terms:search_terms,page:1,template:template})},showSearchSubmit:function(event){$(event.delegateTarget).find("[type=submit]").addClass("sz-show");if($("[type=submit]").hasClass("sz-hide")){$("[type=submit]").removeClass("sz-hide")}},resetSearch:function(event){if(!$(event.target).val()){$(event.delegateTarget).submit()}else{$(event.delegateTarget).find("[type=submit]").show()}},buttonAction:function(event){var self=event.data,target=$(event.currentTarget),action=target.data("sz-btn-action"),nonceUrl=target.data("sz-nonce"),item=target.closest("[data-sz-item-id]"),item_id=item.data("sz-item-id"),item_inner=target.closest(".list-wrap"),object=item.data("sz-item-component"),nonce="";if(!action||!item_id||!object){return event}event.preventDefault();if(undefined!==SZ_Nouveau[action+"_confirm"]&&false===window.confirm(SZ_Nouveau[action+"_confirm"])||target.hasClass("pending")){return false}if(nonceUrl){nonce=nonceUrl.split("?_wpnonce=");nonce=nonce[1]}else{nonce=self.getLinkParams(target.prop("href"),"_wpnonce")}var friends_actions_map={is_friend:"remove_friend",not_friends:"add_friend",pending:"withdraw_friendship",accept_friendship:"accept_friendship",reject_friendship:"reject_friendship"};if("members"===object&&undefined!==friends_actions_map[action]){action=friends_actions_map[action];object="friends"}target.addClass("pending loading");self.ajax({action:object+"_"+action,item_id:item_id,_wpnonce:nonce},object).done(function(response){if(false===response.success){item_inner.prepend(response.data.feedback);target.removeClass("pending loading");item.find(".sz-feedback").fadeOut(6e3)}else{if("groups"===object){if(undefined!==response.data.is_group&&response.data.is_group){return window.location.reload()}}else if("events"===object){if(undefined!==response.data.is_event&&response.data.is_event){return window.location.reload()}}if(undefined!==response.data.is_user&&response.data.is_user){target.parent().html(response.data.feedback);item.fadeOut(1500);return}if($(self.objectNavParent+' [data-sz-scope="personal"]').length){var personal_count=Number($(self.objectNavParent+' [data-sz-scope="personal"] span').html())||0;if(-1!==$.inArray(action,["leave_group","remove_friend"])){personal_count-=1}else if(-1!==$.inArray(action,["join_group"])){personal_count+=1}if(personal_count<0){personal_count=0}$(self.objectNavParent+' [data-sz-scope="personal"] span').html(personal_count)}target.parent().replaceWith(response.data.contents)}})},closeNotice:function(event){var closeBtn=$(event.currentTarget);event.preventDefault();if("clear"===closeBtn.data("sz-close")){if(undefined!==$.cookie("sz-message")){$.removeCookie("sz-message")}if(undefined!==$.cookie("sz-message-type")){$.removeCookie("sz-message-type")}}if(closeBtn.closest(".sz-feedback").hasClass("sz-sitewide-notice")){bp.Nouveau.ajax({action:"messages_dismiss_sitewide_notice"},"messages")}closeBtn.closest(".sz-feedback").remove()},paginateAction:function(event){var self=event.data,navLink=$(event.currentTarget),pagArg,scope=null,object,objectData,filter=null,search_terms=null,extras=null;pagArg=navLink.closest("[data-sz-pagination]").data("sz-pagination")||null;if(null===pagArg){return event}event.preventDefault();object=$(event.delegateTarget).data("sz-list")||null;if(null!==object){objectData=self.getStorage("sz-"+object);if(undefined!==objectData.scope){scope=objectData.scope}if(undefined!==objectData.filter){filter=objectData.filter}if(undefined!==objectData.extras){extras=objectData.extras}}if($('#sportszone [data-sz-search="'+object+'"] input[type=search]').length){search_terms=$('#sportszone [data-sz-search="'+object+'"] input[type=search]').val()}var queryData={object:object,scope:scope,filter:filter,search_terms:search_terms,extras:extras,page:self.getLinkParams(navLink.prop("href"),pagArg)||1};self.objectRequest(queryData)}};bp.Nouveau.start()})(bp,jQuery);